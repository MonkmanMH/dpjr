<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="dpjr">
<title>Data generation—CR25 orders • dpjr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Data generation—CR25 orders">
<meta property="og:description" content="dpjr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">dpjr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/data_list.html">Data list</a>
    <a class="dropdown-item" href="../articles/data_licenses.html">Data licenses</a>
    <a class="dropdown-item" href="../articles/data_generate_cr25_order.html">Data generation—CR25 orders</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/MonkmanMH/dpjr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Data generation—CR25 orders</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/MonkmanMH/dpjr/blob/HEAD/vignettes/data_generate_cr25_order.Rmd" class="external-link"><code>vignettes/data_generate_cr25_order.Rmd</code></a></small>
      <div class="d-none name"><code>data_generate_cr25_order.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This set of R chunks creates a synthetic dataset that presents a variety of data wrangling challenges, as well as some interesting analytic opportunities.</p>
<p>This is based on my own experience in the late 1980s, to a time when I was working for a wholesale company that distributed LPs, cassettes, and those new-fangled compact discs to a wide range of retailers.</p>
<p>The central table in this relational database shows the details of each store’s orders…but this table needs to be compiled for four quarterly CSV files.</p>
<p>These can then be linked to other tables about the stores.</p>
</div>
<div class="section level2">
<h2 id="the-scenario">The Scenario<a class="anchor" aria-label="anchor" href="#the-scenario"></a>
</h2>
The fictional wholesale company, CR25 (for “Classic Rock 25”) only sells 25 album titles. They are the biggest selling / most famous albums by the 25 most-played artists shown in Walt Hickey’s article “Why Classic Rock Isn’t What It Used To Be”. ^[Walt Hickey, <a href="https://fivethirtyeight.com/features/why-classic-rock-isnt-what-it-used-to-be/" class="external-link">Why Classic Rock Isn’t What It Used To Be</a> (FiveThirtyEight, 2014-07-07).
<p>
</p>
<p>The GitHub page with the data for Walt Hickey’s article is available through <a href="https://github.com/fivethirtyeight/data/tree/master/classic-rock" class="external-link">GitHub</a>.]</p>
<div class="section level3">
<h3 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h3>
<p>The first step is to install the necessary packages. I also set the seed to <a href="https://www.youtube.com/watch?v=axLRUszuu9I" class="external-link">a number associated with a classic rock staple</a>, so that future runs of the code will generate the same data table. This is important, as some of the lessons in the course were based on summary tables drawn from the master file.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># tidyverse packages</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## Attaching package: 'dplyr'</span></code></pre>
<pre><code><span class="co">## The following objects are masked from 'package:stats':</span>
<span class="co">## </span>
<span class="co">##     filter, lag</span></code></pre>
<pre><code><span class="co">## The following objects are masked from 'package:base':</span>
<span class="co">## </span>
<span class="co">##     intersect, setdiff, setequal, union</span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## Attaching package: 'lubridate'</span></code></pre>
<pre><code><span class="co">## The following objects are masked from 'package:base':</span>
<span class="co">## </span>
<span class="co">##     date, intersect, setdiff, union</span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="co">#</span>
<span class="co"># utilities</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">8675309</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="input-data">Input data<a class="anchor" aria-label="anchor" href="#input-data"></a>
</h3>
<p>To create the album list, I created a csv file with the artist and percentage of all plays fields, using the table in the article (which is displayed as an image; note that there appears to be an error in the table, in that Boston has a lower rank but a higher percentage than Queen or Journey). I also added a representative album by that artist—I used some judgement here. The album is the biggest selling, most famous, and/or the one with the most hit singles that the artist made. I also opted for a “no compilations” rule; one could make the case that, as one example, The Rolling Stones might be better or more accurately represented by <em>Hot Rocks</em>.</p>
<p>I also added a price field; albums released before 1976 are $7.98, <a href="https://en.wikipedia.org/wiki/Hard_Promises#History" class="external-link">those released 1976-1981 are $8.98</a>, and 1982 and beyond are $9.98. The sole exception to this is Pink Floyd’s double album <em>The Wall</em>, which I priced at $14.98.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">albumlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="fu">dpjr</span><span class="fu">::</span><span class="fu"><a href="../reference/dpjr_data.html">dpjr_data</a></span><span class="op">(</span><span class="st">"cr25/cr25_538.csv"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">25</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">6</span></span>
<span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">## <span style="font-weight: bold;">Delimiter:</span> ","</span>
<span class="co">## <span style="color: #BB0000;">chr</span> (2): artist, album</span>
<span class="co">## <span style="color: #00BB00;">dbl</span> (4): rank, year, pct_plays, price</span>
<span class="co">## </span>
<span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span>
<span class="co">## <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">albumlist</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 25 × 6</span></span>
<span class="co">##     rank artist                        album               year pct_plays price</span>
<span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span>     1 Led Zeppelin                  IV (untitled)       <span style="text-decoration: underline;">1</span>971       4.1  7.98</span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span>     2 Van Halen                     1984                <span style="text-decoration: underline;">1</span>984       3.3  9.98</span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span>     3 The Rolling Stones            Sticky Fingers      <span style="text-decoration: underline;">1</span>971       3    7.98</span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span>     4 Pink Floyd                    The Wall            <span style="text-decoration: underline;">1</span>979       2.8 15.0 </span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span>     5 Tom Petty &amp; The Heartbreakers Hard Promises       <span style="text-decoration: underline;">1</span>981       2.6  8.98</span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span>     6 AC/DC                         Back in Black       <span style="text-decoration: underline;">1</span>980       2.3  8.98</span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span>     7 Aerosmith                     Toys in the Attic   <span style="text-decoration: underline;">1</span>975       2.2  7.98</span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span>     8 ZZ Top                        Eliminator          <span style="text-decoration: underline;">1</span>983       1.9  9.98</span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span>     9 The Beatles                   Abbey Road          <span style="text-decoration: underline;">1</span>969       1.9  7.98</span>
<span class="co">## <span style="color: #BCBCBC;">10</span>    10 Queen                         Night at the Opera  <span style="text-decoration: underline;">1</span>975       1.8  7.98</span>
<span class="co">## <span style="color: #949494;"># … with 15 more rows</span></span></code></pre>
<p>The next step was to create a csv file with some fictional stores. What I did here was use the names of now-defunct Canadian chains that were record retailers active in the 70s and 80s. You can find them listed in the <a href="https://en.wikipedia.org/wiki/List_of_defunct_Canadian_companies#Consumer_retail,_including_grocery" class="external-link">Wikipedia List of defunct Canadian companies</a> I left off HMV, as it was an international brand that was late to the market.</p>
<p>I also assigned each store to one of four regions (based on the cardinal points of the compass), and gave them a store ID number.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">storelist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="fu">dpjr</span><span class="fu">::</span><span class="fu"><a href="../reference/dpjr_data.html">dpjr_data</a></span><span class="op">(</span><span class="st">"cr25/cr25_storelist.csv"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">45</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">4</span></span>
<span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">## <span style="font-weight: bold;">Delimiter:</span> ","</span>
<span class="co">## <span style="color: #BB0000;">chr</span>  (3): chain, region, store.id</span>
<span class="co">## <span style="color: #0000BB;">date</span> (1): open_date</span>
<span class="co">## </span>
<span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span>
<span class="co">## <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">storelist</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 45 × 4</span></span>
<span class="co">##    chain               region open_date  store.id</span>
<span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span> A&amp;A Records         east   2019-01-01 X001    </span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span> A&amp;A Records         east   2019-01-01 X002    </span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span> A&amp;A Records         east   2019-01-01 X003    </span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span> A&amp;A Records         east   2019-01-01 X004    </span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span> A&amp;A Records         east   2019-01-01 X005    </span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span> Kelly's Stereo Mart east   2019-01-01 X017    </span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span> Kelly's Stereo Mart east   2019-01-01 X018    </span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span> Sam the Record Man  east   2019-01-01 X028    </span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span> Sam the Record Man  east   2019-01-01 X029    </span>
<span class="co">## <span style="color: #BCBCBC;">10</span> Sam the Record Man  east   2019-01-01 X030    </span>
<span class="co">## <span style="color: #949494;"># … with 35 more rows</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">storelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">chain</span>, <span class="va">region</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">tally</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 12 × 3</span></span>
<span class="co">## <span style="color: #949494;"># Groups:   chain [4]</span></span>
<span class="co">##    chain               region     n</span>
<span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span> A&amp;A Records         east       5</span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span> A&amp;A Records         south      5</span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span> A&amp;B Sound           north      1</span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span> A&amp;B Sound           west       5</span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span> Kelly's Stereo Mart east       2</span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span> Kelly's Stereo Mart north      2</span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span> Kelly's Stereo Mart south      5</span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span> Kelly's Stereo Mart west       2</span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span> Sam the Record Man  east       3</span>
<span class="co">## <span style="color: #BCBCBC;">10</span> Sam the Record Man  north      2</span>
<span class="co">## <span style="color: #BCBCBC;">11</span> Sam the Record Man  south     10</span>
<span class="co">## <span style="color: #BCBCBC;">12</span> Sam the Record Man  west       3</span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">storelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">region</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">tally</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 4 × 2</span></span>
<span class="co">##   region     n</span>
<span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;">1</span> east      10</span>
<span class="co">## <span style="color: #BCBCBC;">2</span> north      5</span>
<span class="co">## <span style="color: #BCBCBC;">3</span> south     20</span>
<span class="co">## <span style="color: #BCBCBC;">4</span> west      10</span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">storelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">chain</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">tally</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 4 × 2</span></span>
<span class="co">##   chain                   n</span>
<span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;">1</span> A&amp;A Records            10</span>
<span class="co">## <span style="color: #BCBCBC;">2</span> A&amp;B Sound               6</span>
<span class="co">## <span style="color: #BCBCBC;">3</span> Kelly's Stereo Mart    11</span>
<span class="co">## <span style="color: #BCBCBC;">4</span> Sam the Record Man     18</span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="create-order">Create order<a class="anchor" aria-label="anchor" href="#create-order"></a>
</h2>
<div class="section level3">
<h3 id="order-date">order date<a class="anchor" aria-label="anchor" href="#order-date"></a>
</h3>
<p><a href="https://cran.r-project.org/web/packages/lubridate/vignettes/lubridate.html" class="external-link uri">https://cran.r-project.org/web/packages/lubridate/vignettes/lubridate.html</a></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">jan01</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2019-01-01"</span><span class="op">)</span>
<span class="va">startdate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/as_date.html" class="external-link">as_date</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/round_date.html" class="external-link">floor_date</a></span><span class="op">(</span><span class="va">jan01</span>, <span class="st">"year"</span><span class="op">)</span><span class="op">)</span>
<span class="va">enddate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/as_date.html" class="external-link">as_date</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/round_date.html" class="external-link">ceiling_date</a></span><span class="op">(</span><span class="va">jan01</span>, <span class="st">"year"</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/period.html" class="external-link">days</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="va">daterange</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>orderdate <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/as_date.html" class="external-link">as_date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">startdate</span><span class="op">:</span><span class="va">enddate</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="va">orderdate_fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span> 
<span class="va">daterange</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample_n.html" class="external-link">sample_n</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">orderdate</span><span class="op">)</span> 
<span class="op">}</span>  

<span class="co"># set the size of the order based on year quarter</span>
<span class="co"># - same number of orders but biggest in 4th quarter, smallest in 1st</span>
<span class="va">order_mean_fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">orderdate</span><span class="op">)</span><span class="op">{</span>
  <span class="va">order_qtr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/quarter.html" class="external-link">quarter</a></span><span class="op">(</span><span class="va">orderdate</span><span class="op">)</span>
  <span class="va">order_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span>
    <span class="va">order_qtr</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="fl">4</span>,
    <span class="va">order_qtr</span> <span class="op">==</span> <span class="fl">4</span> <span class="op">~</span> <span class="fl">6</span>,
    <span class="cn">TRUE</span> <span class="op">~</span> <span class="fl">5</span>
  <span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># function to randomly select the store</span>
<span class="va">store_fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span> 
<span class="va">storelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample_n.html" class="external-link">sample_n</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">store.id</span><span class="op">)</span> 
<span class="op">}</span>  </code></pre></div>
</div>
<div class="section level3">
<h3 id="album_order_fun">album_order_fun<a class="anchor" aria-label="anchor" href="#album_order_fun"></a>
</h3>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># - `rpois` sets the mean value of poisson distribution from which random value is pulled</span>

<span class="va">album_order_fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample_n.html" class="external-link">sample_n</a></span><span class="op">(</span><span class="va">albumlist</span>, <span class="fl">1</span>, weight <span class="op">=</span> <span class="va">pct_plays</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">artist</span>, <span class="va">album</span>, <span class="va">price</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>format <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lp"</span>, <span class="st">"cass"</span><span class="op">)</span>, <span class="fl">1</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.33</span>, <span class="fl">0.67</span><span class="op">)</span><span class="op">)</span>,
         qty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="multiples">multiples<a class="anchor" aria-label="anchor" href="#multiples"></a>
</h3>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># TEST</span>
<span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">7</span><span class="op">)</span>
<span class="va">order_final</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>artist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="op">)</span>,
                          album <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="op">)</span>,
                          price <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">as.double</a></span><span class="op">(</span><span class="op">)</span>,
                          format <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="op">)</span>,
                          qty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="op">)</span>,
                          stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>  

<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span><span class="op">{</span>
  <span class="va">order_final</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">album_order_fun</span><span class="op">(</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">order_final</span></code></pre></div>
<pre><code><span class="co">##          artist      album price format qty</span>
<span class="co">## 1   The Beatles Abbey Road  7.98     lp   5</span>
<span class="co">## 2    Pink Floyd   The Wall 14.98     lp   9</span>
<span class="co">## 3     The Doors  The Doors  7.98     lp   4</span>
<span class="co">## 4 Fleetwood Mac    Rumours  8.98   cass   4</span></code></pre>
<p>test orderdate and order_mean</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">orderdate</span> <span class="op">&lt;-</span> <span class="fu">orderdate_fun</span><span class="op">(</span><span class="op">)</span>
<span class="va">orderdate</span></code></pre></div>
<pre><code><span class="co">## [1] "2019-06-04"</span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">order_mean</span> <span class="op">&lt;-</span> <span class="fu">order_mean_fun</span><span class="op">(</span><span class="va">orderdate</span><span class="op">)</span>
<span class="va">order_mean</span></code></pre></div>
<pre><code><span class="co">## [1] 5</span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">order_fun_1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span>
  <span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>
  <span class="va">order_final</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>artist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="op">)</span>,
                          album <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="op">)</span>,
                          price <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">as.double</a></span><span class="op">(</span><span class="op">)</span>,
                          format <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="op">)</span>,
                          qty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="op">)</span>,
                          stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>  
  
  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span><span class="op">{</span>
    <span class="va">order_final</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">album_order_fun</span><span class="op">(</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="va">order_final</span>
  <span class="op">}</span>


<span class="co">#TEST </span>
<span class="fu">order_fun_1</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##           artist            album price format qty</span>
<span class="co">## 1 Lynyrd Skynyrd   Second Helping  7.98     lp   2</span>
<span class="co">## 2  Fleetwood Mac          Rumours  8.98     lp   1</span>
<span class="co">## 3      The Doors        The Doors  7.98     lp   3</span>
<span class="co">## 4         Eagles Hotel California  8.98   cass   3</span>
<span class="co">## 5   Led Zeppelin    IV (untitled)  7.98   cass   6</span>
<span class="co">## 6             U2              War  9.98     lp   3</span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># now with order date and store id appended after the run</span>

<span class="va">order_fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span>
  
  <span class="va">orderdate</span> <span class="op">&lt;-</span> <span class="fu">orderdate_fun</span><span class="op">(</span><span class="op">)</span>

<span class="co"># conditional on store open date being before random order date  </span>
  <span class="va">orderstore.id</span> <span class="op">&lt;-</span> <span class="fu">store_fun</span><span class="op">(</span><span class="op">)</span>
  
  <span class="va">store.opendate</span> <span class="op">&lt;-</span> <span class="va">storelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">store.id</span> <span class="op">==</span> <span class="va">orderstore.id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">open_date</span><span class="op">)</span>

  <span class="kw">if</span><span class="op">(</span><span class="va">store.opendate</span> <span class="op">&lt;</span> <span class="va">orderdate</span><span class="op">)</span><span class="op">{</span>

    <span class="va">order_mean</span> <span class="op">&lt;-</span> <span class="fu">order_mean_fun</span><span class="op">(</span><span class="va">orderdate</span><span class="op">)</span>
    <span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">order_mean</span><span class="op">)</span>
  

  <span class="co"># define blank form  </span>
  <span class="va">order_final</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>artist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="op">)</span>,
                          album <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="op">)</span>,
                          price <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">as.double</a></span><span class="op">(</span><span class="op">)</span>,
                          format <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="op">)</span>,
                          qty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="op">)</span>,
                          stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>  
  
  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span><span class="op">{</span>
    <span class="va">order_final</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">album_order_fun</span><span class="op">(</span><span class="op">)</span>
    <span class="op">}</span>
  
  <span class="va">order_final</span> <span class="op">&lt;-</span> <span class="va">order_final</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>orderdate <span class="op">=</span> <span class="va">orderdate</span>,
           store.id <span class="op">=</span> <span class="va">orderstore.id</span><span class="op">)</span>
  
  <span class="va">order_final</span>
  
  <span class="co"># end if</span>
  <span class="op">}</span>
<span class="co"># end funtion</span>
<span class="op">}</span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">order_fun</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##                          artist             album price format qty  orderdate</span>
<span class="co">## 1                         AC/DC     Back in Black  8.98   cass   5 2019-10-03</span>
<span class="co">## 2                            U2               War  9.98     lp   4 2019-10-03</span>
<span class="co">## 3                     The Doors         The Doors  7.98   cass   1 2019-10-03</span>
<span class="co">## 4 Tom Petty &amp; The Heartbreakers     Hard Promises  8.98   cass   3 2019-10-03</span>
<span class="co">## 5             Steve Miller Band Fly Like an Eagle  8.98     lp   4 2019-10-03</span>
<span class="co">##   store.id</span>
<span class="co">## 1     X022</span>
<span class="co">## 2     X022</span>
<span class="co">## 3     X022</span>
<span class="co">## 4     X022</span>
<span class="co">## 5     X022</span></code></pre>
<p>Now a run of multiple orders…</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">750</span>


<span class="va">order_multi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>artist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="op">)</span>,
                          album <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="op">)</span>,
                          price <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">as.double</a></span><span class="op">(</span><span class="op">)</span>,
                          format <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="op">)</span>,
                          qty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="op">)</span>,
                          orderdate <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/as_date.html" class="external-link">as_date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,
                          store.id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="op">)</span>,
                          stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>  
  
  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">m</span><span class="op">)</span><span class="op">{</span>
    <span class="va">order_final</span> <span class="op">&lt;-</span> <span class="fu">order_fun</span><span class="op">(</span><span class="op">)</span>
    <span class="va">order_multi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">order_multi</span>, <span class="va">order_final</span><span class="op">)</span>
  <span class="op">}</span>
  

<span class="co">#write_csv(order_multi, "cr25_order_multi.csv")  </span>
<span class="co">#write_rds(order_multi, "cr25_order_multi.rds")  </span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">order_multi</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##               artist             album price format qty  orderdate store.id</span>
<span class="co">## 1          Aerosmith Toys in the Attic  7.98   cass   1 2019-11-13     X008</span>
<span class="co">## 2             Boston            Boston  8.98   cass   2 2019-11-13     X008</span>
<span class="co">## 3              Heart   Dreamboat Annie  7.98   cass   1 2019-11-13     X008</span>
<span class="co">## 4 The Rolling Stones    Sticky Fingers  7.98     lp   5 2019-11-13     X008</span>
<span class="co">## 5     Lynyrd Skynyrd    Second Helping  7.98   cass   5 2019-11-13     X008</span>
<span class="co">## 6         Pink Floyd          The Wall 14.98   cass   3 2019-11-13     X008</span></code></pre>
<div class="section level4">
<h4 id="summary-tables">Summary tables<a class="anchor" aria-label="anchor" href="#summary-tables"></a>
</h4>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">order_multi</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">store.id</span>, <span class="va">orderdate</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">tally</a></span><span class="op">(</span><span class="op">)</span>


<span class="va">order_multi</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">artist</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>qty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">qty</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">qty</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Build a large scale summary table</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">order_multi</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>order_price <span class="op">=</span> <span class="va">qty</span> <span class="op">*</span> <span class="va">price</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">artist</span>, <span class="va">format</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>qty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">qty</span><span class="op">)</span>,
            cost <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">order_price</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">qty</span><span class="op">)</span><span class="op">)</span>


<span class="va">order_multi</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>order_price <span class="op">=</span> <span class="va">qty</span> <span class="op">*</span> <span class="va">price</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">storelist</span>, by <span class="op">=</span> <span class="st">"store.id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">chain</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>qty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">qty</span><span class="op">)</span>,
            cost <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">order_price</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">qty</span><span class="op">)</span><span class="op">)</span>

<span class="va">order_multi</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>order_price <span class="op">=</span> <span class="va">qty</span> <span class="op">*</span> <span class="va">price</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">storelist</span>, by <span class="op">=</span> <span class="st">"store.id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">region</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>qty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">qty</span><span class="op">)</span>,
            cost <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">order_price</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pct_of_sales <span class="op">=</span> <span class="va">cost</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">cost</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">qty</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="future-development">Future development<a class="anchor" aria-label="anchor" href="#future-development"></a>
</h2>
<p>It could also be expanded to include additional years (with some trends embedded), inventory management, and customer relationship management (CRM).</p>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Martin Monkman.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
